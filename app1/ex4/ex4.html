<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>JRostand Stade - Exo 4</title>
    <link rel="stylesheet" type="text/css" href="./style.css" />
</head>
<body>

<h1>Reperes</h1>
<hr>
<div id="map"></div>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA7Y32T_PJHZxYcK3BJYJFNwSl6cuvLXpo"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script>
    var markers;

    google.maps.event.addDomListener(window, 'load', loadDoc);

    function loadDoc() {
        $.ajax({
            url: "markersJrostand.json",
            method: "GET",
            dataType: "json",
            success: function(dataMarkers){
                markers = dataMarkers;
                initMap();
            }
        });
    }

    function initMap(){
        var options = {
            center: new google.maps.LatLng(48.9593, 2.5477),
            zoom: 15,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        var map = new google.maps.Map(document.getElementById("map"), options);

        var path = [];

        for (let i = 0; i < markers.length; i++) {
            let latlng = markers[i];
            let point = new google.maps.LatLng(latlng.lat, latlng.lng);
            path.push(point);

            let marker = new google.maps.Marker({
                position: point,
                map: map,
                title: 'Marker ' + latlng.id
            });

            let infowindow = new google.maps.InfoWindow({
                content: 'ID du marqueur : ' + latlng.id
            });

            marker.addListener('click', function() {
                infowindow.open(map, marker);
            });
        }

        if (path.length > 1) {
            var parcours = new google.maps.Polyline({
                path: path,
                geodesic: true,
                strokeColor: '#FF0000',
                strokeOpacity: 1.0,
                strokeWeight: 2
            });
            parcours.setMap(map);
        }
    }
</script>
</body>
</html>